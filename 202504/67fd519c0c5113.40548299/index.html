<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>打砖块小游戏</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            background: #2c3e50;
            font-family: Arial;
        }
        #gameCanvas {
            border: 2px solid #fff;
            border-radius: 5px;
            margin-top: 20px;
            background: #34495e;
        }
        #info {
            position: absolute;
            top: 10px;
            color: white;
            font-size: 20px;
        }
        #gameOver {
            display: none;
            position: absolute;
            color: #e74c3c;
            font-size: 48px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div id="info">得分：0 | 生命：3</div>
    <div id="gameOver">游戏结束！</div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const info = document.getElementById('info');
        const gameOver = document.getElementById('gameOver');

        // 游戏状态[3,4](@ref)
        const game = {
            score: 0,
            lives: 3,
            isGameOver: false,
            paddle: {
                x: canvas.width/2 - 50,
                y: canvas.height - 20,
                width: 100,
                height: 10
            },
            ball: {
                x: canvas.width/2,
                y: canvas.height - 30,
                radius: 8,
                dx: 4,
                dy: -4
            },
            bricks: []
        };

        // 初始化砖块[3,4](@ref)
        function createBricks() {
            const rows = 5, cols = 8;
            const brickWidth = 80, brickHeight = 20;
            const padding = 10;
            
            for(let i=0; i<rows; i++){
                for(let j=0; j<cols; j++){
                    game.bricks.push({
                        x: j*(brickWidth + padding) + 30,
                        y: i*(brickHeight + padding) + 30,
                        visible: true
                    });
                }
            }
        }

        // 绘制元素[3,2](@ref)
        function drawPaddle() {
            ctx.fillStyle = '#3498db';
            ctx.fillRect(game.paddle.x, game.paddle.y, game.paddle.width, game.paddle.height);
        }

        function drawBall() {
            ctx.beginPath();
            ctx.arc(game.ball.x, game.ball.y, game.ball.radius, 0, Math.PI*2);
            ctx.fillStyle = '#e74c3c';
            ctx.fill();
            ctx.closePath();
        }

        function drawBricks() {
            game.bricks.forEach(brick => {
                if(brick.visible) {
                    ctx.fillStyle = '#2ecc71';
                    ctx.fillRect(brick.x, brick.y, 80, 20);
                }
            });
        }

        // 游戏逻辑[3,4](@ref)
        function updateGame() {
            // 球移动
            game.ball.x += game.ball.dx;
            game.ball.y += game.ball.dy;

            // 边界碰撞
            if(game.ball.x + game.ball.radius > canvas.width || 
               game.ball.x - game.ball.radius < 0) game.ball.dx *= -1;
            if(game.ball.y - game.ball.radius < 0) game.ball.dy *= -1;

            // 挡板碰撞
            if(game.ball.y + game.ball.radius > game.paddle.y &&
               game.ball.x > game.paddle.x && 
               game.ball.x < game.paddle.x + game.paddle.width) {
                game.ball.dy = -Math.abs(game.ball.dy);
            }

            // 砖块碰撞[3](@ref)
            game.bricks.forEach(brick => {
                if(brick.visible && 
                   game.ball.x > brick.x && 
                   game.ball.x < brick.x + 80 &&
                   game.ball.y > brick.y && 
                   game.ball.y < brick.y + 20) {
                    brick.visible = false;
                    game.score += 10;
                    game.ball.dy *= -1;
                }
            });

            // 生命值检测
            if(game.ball.y + game.ball.radius > canvas.height) {
                game.lives--;
                resetBall();
                if(game.lives <= 0) {
                    game.isGameOver = true;
                    gameOver.style.display = 'block';
                }
            }
        }

        function resetBall() {
            game.ball.x = canvas.width/2;
            game.ball.y = canvas.height - 30;
            game.ball.dx = 4 * (Math.random() > 0.5 ? 1 : -1);
            game.ball.dy = -4;
        }

        // 事件监听[3,2](@ref)
        document.addEventListener('keydown', (e) => {
            if(game.isGameOver) return;
            if(e.key === 'ArrowLeft' && game.paddle.x > 0) game.paddle.x -= 20;
            if(e.key === 'ArrowRight' && game.paddle.x < canvas.width - game.paddle.width) game.paddle.x += 20;
        });

        // 游戏循环[3](@ref)
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if(!game.isGameOver) {
                updateGame();
                info.innerHTML = `得分：${game.score} | 生命：${game.lives}`;
            }

            drawBricks();
            drawPaddle();
            drawBall();
            requestAnimationFrame(gameLoop);
        }

        // 初始化游戏
        createBricks();
        gameLoop();
    </script>
</body>
</html>